<odoo>
    <record id="view_tree_service_request" model="ir.ui.view">
        <field name="name">waste.service.request.tree</field>
        <field name="model">waste.service.request</field>
        <field name="arch" type="xml">
            <tree string="Waste Service Request">
                <field name="partner_id"/>
                <field name="service_type"/>
                <field name="state" readonly="1"/>
                <field name="pickup_point_id"/>
                <field name="dropoff_container_ids" widget="many2many_tags" optional="hide"/>
                <field name="lifted_bin_ids" widget="many2many_tags" optional="hide"/>
                <field name="dropped_bin_ids" widget="many2many_tags" optional="hide"/>
                <field name="pickup_point_id" optional="hide"/>
                <field name="shunted_bin_ids" widget="many2many_tags" optional="hide"/>
                <field name="shunt_from_id" optional="hide"/>
                <field name="shunt_to_id" optional="hide"/>
            </tree>
        </field>
    </record>
    <record id="view_form_service_request" model="ir.ui.view">
        <field name="name">waste.service.request.form</field>
        <field name="model">waste.service.request</field>
        <field name="arch" type="xml">
            <form string="Waste Service Request">
                <header>
                    <button string="Draft" type="object" name="action_draft" class="btn-primary"/>
                    <!--                            invisible="state == 'done'"/>-->
                    <button string="Mark as Done" type="object" name="action_mark_done" class="btn-primary"/>

                    <field name="condition" widget="statusbar"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" readonly="0"/>
                        </h1>
                    </div>

                    <group string="container location">
                        <group>
                            <field name="partner_id"
                                   widget="res_partner_many2one"
                                   context="{'res_partner_search_mode': 'customer', 'show_address': 1, 'show_vat': True}"
                                   placeholder="Type to find a customer..."/>/>
                            <field name="service_type"/>
                            <field name="container_type" required="1" widget="radio" options="{'horizontal': True}"/>

                        </group>
                        <group>
                            <field name="pickup_point_id" invisible="0"/>
                            <field name="dropoff_container_ids" widget="many2many_tags"
                                   invisible="service_type not in ('placement',)"
                                   domain="['&amp;','&amp;',('status', '=', 'intact'), ('tank_volume', 'not in',('7000L','9000L','11000L','12000L','15000L')), ('pickup_point_id', '=', False)]"/>


                            <field name="dropoff_container_ids" widget="many2many_tags"
                                   invisible="service_type not in ( 'removal')"
                                   domain="['&amp;', ('status', 'in', ['intact','in_use']), ('pickup_point_id', '=', pickup_id) ]"/>


                            <field name="dropoff_container_ids" widget="many2many_tags"
                                   invisible="service_type not in ( 'collection') or container_type != 'bin'"
                                   domain="['&amp;','&amp;',('status', 'in', ['intact','in_use']),('container_type' ,'!=','tank'),('pickup_point_id', '=', pickup_id) ]"/>

                            <field name="pickup_id" invisible="1"/>
                            <!--  Swap  -->


                            <field name="lifted_bin_ids" widget="many2many_tags"
                                   invisible="service_type != 'swap'"
                                   domain="['&amp;',('status', 'in', ['broken','in_use','un_use']),('pickup_point_id', '=', pickup_id) ]"/>
                            <field name="dropped_bin_ids" widget="many2many_tags"
                                   invisible="service_type != 'swap'"
                                   domain="[('status', '=', 'intact')]"/>
                            <field name="pickup_point_id" invisible="service_type != 'swap'"/>


                            <!--                      Shunt  -->

                            <field name="shunted_bin_ids" widget="many2many_tags"
                                   invisible="service_type != 'shunt'"
                                   domain="['&amp;', ('status', 'in', ['in_use','un_use',]), ('pickup_point_id', '=', pickup_id) ]"/>
                            <!--                        <field name="shunt_from_id"/>-->
                            <field name="shunt_to_id" invisible="service_type != 'shunt'"/>

                            <field name="tank_ids" widget="many2many_tags" invisible="container_type != 'tank'"
                                   domain="['&amp;', '&amp;', '&amp;', ('status', 'in', ['in_use', 'un_use']), ('tank_volume', 'in',('7000L','9000L','11000L','12000L','15000L')), ('container_type', '=', 'tank'), ('pickup_point_id', '=', pickup_id)]"/>


                            <field name="tank_volume" readonly="1" invisible="container_type != 'tank'"/>

                                <field name="liters_collected" readonly="0"
                                       invisible="container_type  != 'tank' or service_type != 'collection'"/>
                                <field name="liters_remaining" readonly="1"
                                       invisible="container_type != 'tank' or service_type != 'collection'"/>



                            <!--                        <field name="pickup_point_id"/>-->

                        </group>
                    </group>


                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" groups="base.group_user"/>
                    <field name="activity_ids"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>
    <record id="action_waste_service_request" model="ir.actions.act_window">
        <field name="name">Waste service request</field>
        <field name="res_model">waste.service.request</field>
        <field name="view_mode">tree,form</field>
    </record>

</odoo>